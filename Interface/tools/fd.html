<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TDS Helper for FDs
    </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
    .separator
    {
        display: flex;
    }
    #ranges
    {
        text-align-last: center;
        border-style: solid;
        border-radius: 20px;
        border-color: blue;
        color: #ffffff;
        background-color: blueviolet;
    }
    #options
    {
        max-width: 450px;
    }

    .container
    {
        max-width: 330px;
        border-style: solid;
        border-radius: 20px;
        border-color: blue;
        color: #ffffff;
        background-color: blueviolet;
    }

    #headings
    {
        display: flex;
        font-size: 20px;
    }
    
    #box{
    background-color: blueviolet;
    font-family: 'Courier New', Courier, monospace;
    font-weight: 100;
    border-radius: 20px;
    }

.buttons{
    background-color: blueviolet;
    color: #ffffff;
    border-radius: 20px;
    font-size: large;
}

.taxed{
    color: crimson;
}

.untaxed{
    color: #8be615;
}

#conclusion{
    background-color: aquamarine;
}
    </style>
    <script>
    function incomplete_data_check(){
    let principal = Number(document.getElementById('p').value);
    let rate = Number(document.getElementById('r').value);
    let time = Number(document.getElementById('t').value);
    let checked_age,checked_frequency;

    let age = document.getElementsByName('age');
    for(let i=0;i<age.length;i++) {
        if( age[i].checked ) {
            checked_age = Number(i);
        }
    }

    let frequency = document.getElementsByName('frequency');
    for(let i=0;i<frequency.length;i++) {
        if( frequency[i].checked ) {
            checked_frequency = Number(i);
        }
    }

    if( !principal || !rate || !time || checked_age==undefined || checked_frequency==undefined ){
        alert("Incomplete Data");
    }else if( principal<=0 || rate<=0 || time<=0 ){
        alert("Invalid Data");
    }else{
        clear_data();
        analyse(checked_age,checked_frequency);
    }
    return false;
}

function clear_data(){
    document.getElementById('analysis').innerHTML="";
}

function analyse(checked_age,checked_frequency){
    let principal = Number(document.getElementById('p').value);
    let rate = Number(document.getElementById('r').value);
    let time = Number(document.getElementById('t').value);
    
    let age = document.getElementsByName('age');
    let limit = Number( age[checked_age].value);

    let frequency = document.getElementsByName('frequency');
    let compounded = Number( frequency[checked_frequency].value);
    
    let maximum_possible_amount=Math.pow(rate/100+1,time)*principal,maximum_possible_interest=maximum_possible_amount-principal;
    let total_tax=0,generated_interest=0,generated_amount=0;
    
    let P=0,I=0,A=principal,year=0,tax,Ir;
    while(time--){
        year++;
        P = (Number(A)).toFixed(2);
        I = (Number(P) * Number(rate) / Number(100)).toFixed(2);

        if(I>limit){

            tax = (Number(I) / 10).toFixed(2);
            Ir = (Number(I) - Number(tax)).toFixed(2);
            A = (Number(P) + Number(Ir)).toFixed(2);
            document.getElementById('analysis').innerHTML += `
            <div id="box" class="taxed">
            <br>
            ${year}<br>
            Principal = ${P}<br>
            Rate = ${rate}<br>
            Interest Generated= ${I}<br>
            Annual Interest exceeded the non-taxable limit of Rs. ${limit}.<br>
            Tax(TDS) = 10% of Annual Interest<br>
            Tax Amount(TDS) to be Deducted = ${tax}<br>
            Interest to be Compounded after Tax(TDS) is Deducted = ${Ir}<br>
            A = ${A}<br><br>
            </div>
            <br><br>`;

            total_tax += Number(tax);
            
        }else{
            
            A = (Number(P) + Number(I)).toFixed(2);
            document.getElementById('analysis').innerHTML += `
            <div id="box" class="untaxed">
            <br>
            ${year}<br>
            Principal = ${P}<br>
            Rate = ${rate}<br>
            Interest Generated= ${I}<br>
            Annual Interest is in the non-taxable limit of Rs. ${limit}.<br>
            No Tax Amount(TDS) to be Deducted<br>
            A = ${A}<br><br>
            </div>
            <br><br>`;
        }
    }

    document.getElementById('analysis').innerHTML += `
    <div id="conclusion">
    CONCLUSION<br>
    Maximum Possible Interest = Rs. ${maximum_possible_interest.toFixed(2)}<br>
    Maximum Possible Amount = Rs. ${maximum_possible_amount.toFixed(2)}<br>
    Total Tax Deducted = Rs. ${total_tax.toFixed(2)}<br>
    Interest Earned = Rs. ${(A-principal-total_tax).toFixed(2)}<br>
    Total Amount Generated = Rs. ${(A-total_tax).toFixed(2)}<br>
    </div>`;

}
    function p_display(value){
        document.getElementById('p-text').innerHTML=value;
    }
    function r_display(value){
        document.getElementById('r-text').innerHTML=value;
    }
    function t_display(value){
        document.getElementById('t-text').innerHTML=value;
    }
    </script>

</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    
    <form id="details" class="container-sm" onsubmit="return incomplete_data_check()"><br>
    <div class="separator">
        <div class="container-sm" id="ranges">
            <br>
            <div class="container-sm" id="headings">
            <div class="container-sm">PRINCIPAL</div><br>
            <div class="container-sm" id="p-text"></div><br>
            </div>
            <input type="range" class="form-range" id="p" min="5000" max="1000000" step="1000" oninput="p_display(this.value)" required><br>
            <br>
            <div class="container-sm" id="headings">
            <div class="container-sm">RATE</div><br>
            <div class="container-sm" id="r-text"></div><br>
            </div>
            <input type="range" class="form-range" id="r" min="0" max="10" oninput="r_display(this.value)" required><br>
            <br>
            <div class="container-sm" id="headings">
            <div class="container-sm">TIME</div><br>
            <div class="container-sm" id="t-text"></div><br>
            </div>
            <input type="range" class="form-range" id="t" min="1" max="10" oninput="t_display(this.value)" required><br>
            <br>
        </div>  
        <div class="container-sm" id="options">
            <div class="container">
                <div class="container-sm" id="headings">AGE</div>
                <label><input type="radio" name="age" class="form-check-input" value="40000" required>Less Than 60</label><br>
                <label><input type="radio" name="age" class="form-check-input" value="50000" required>More Than 60</label><br>
                <br>
            </div>
            <br>
            <div class="container">
                <div class="container-sm" id="headings">COMPOUNDING FREQUENCY</div>
                <label><input type="radio" name="frequency" class="form-check-input" value="1" required>ANNUALY</label><br>
                <label><input type="radio" name="frequency" class="form-check-input" value="1" required>HALF-YEARLY</label><br>
                <label><input type="radio" name="frequency" class="form-check-input" value="1" required>QUARTERLY</label><br>
                <label><input type="radio" name="frequency" class="form-check-input" value="1" required>MONTHLY</label><br>
                <br>
            </div>
        </div>
    </div>
    <br>
    <div class="container-sm" align="center">
        <input type="submit" class="buttons" value="ANALYSE"><br><br>
        <input type="button" class="buttons" value="CLEAR DATA" onclick="clear_data()">
        <input type="reset" class="buttons" value="CLEAR QUERY">
    </div>
    </form>
    <br>
    <div class="container-sm" id="analysis"></div>
    </div>
</body>
</html>